@require 'constants'

between-tile-spacing = 8px

.editable-ingredient
  white-space nowrap

  .tile
    display inline-flex
    position relative

    // -1 to compensate for the weird bug named below
    margin-right between-tile-spacing - 1

    &:first-child
      margin-left between-tile-spacing

    border-radius standard-border-radius
    height touch-element-size

    transition width transition-duration

    for i in 1 2 3
      &:nth-child({i})
        width "calc(100% - %s)" % (between-tile-spacing + i * between-tile-spacing + (i - 1) * touch-element-size)

    &.is-committed
      // +1 to adjust for some weird bug in the width of input elements
      width touch-element-size + 1

    &.is-hidden
      display none

    > *
      display inline-block
      height inherit


  .tile .image-overlay
    position absolute
    right 0
    width touch-element-size + 1

    pointer-events none

  // Not sure why this is necessary.
  .tile.is-committed.ingredient .image-overlay
    z-index 1


  // HACK HACK HACK
  // Can't figure out why there's an extra pixel of space on this guy.
  .tile.ingredient
    transform translate(0, -1px)

  .tile .accept-button
    border-left none
    border-top-left-radius 0
    border-bottom-left-radius 0
    transition all transition-duration

  .tile.is-committed .accept-button
    width 0
    opacity 0
    transition all transition-duration


  .tile .input-field
    flex 1

  .tile input.input-field
    border 1px solid grey2
    background-color grey0
    font-size body-font-size
    line-height body-font-size

    padding-left 8px
    border-radius standard-border-radius

    margin 0

    transition background-color transition-duration

  .tile.is-committed input.input-field
    opacity 1 // Undo iPhone fading of disabled elements.
    color grey5
    border-color grey2
    background-color grey0a

  .tile:not(.is-committed) input.input-field
    border-top-right-radius 0
    border-bottom-right-radius 0


  .tile .Select.input-field
    &.is-focused:not(.is-open) .Select-control
      box-shadow none
      border-color grey2

    .Select-control
      background-color grey0

      border 1px solid grey2
      height touch-element-size

      // Some hacks to get everything to line up nice.
      .Select-placeholder
        top 2px

      .Select-input
        position relative
        top 2px

      .Select-arrow
        margin-top 4px

    .Select-menu
      max-height 108px

    .Select-option
      background-color grey0
      color grey8

      &.is-focused
        background-color grey0
        color grey8

  .tile.is-committed .Select.input-field
    .Select-control
      padding-right 0

      border-color grey2
      background-color grey0a

      .Select-placeholder
        color grey5

    .Select-arrow
      display none

  .tile:not(.is-committed) .Select.input-field
    .Select-control
      border-top-right-radius 0
      border-bottom-right-radius 0

.iphone-hack-input
  width 0
  height 0
  opacity 0
  padding 0
  border 0
  margin 0
